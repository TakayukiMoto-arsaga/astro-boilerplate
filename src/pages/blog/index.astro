---
import { getCollection } from 'astro:content'
import Layout from '@/layouts/Layout.astro'
import type { HeadPageProps } from '@/layouts/head/types'

// 本番用にビルドするときにのみ、isDraft: trueを含むエントリーを除外
const posts = await getCollection('blog', ({ data }) => {
  return import.meta.env.PROD ? data.isDraft !== true : true
})

const headPage: HeadPageProps = {
  title: 'blog一覧PageTitle',
  description: 'blog一覧ページの説明です。',
  robots: 'all',
  ogType: 'website',
  ogImage: '/src/assets/images/content/blog/ogp.webp',
  ogImageAlt: 'ogImageAlt',
  xCreator: '@xCreator',
  author: 'author',
}
---

<Layout headPage={headPage}>
  {
    posts.map((post) => (
      <a href={`/blog/${post.slug}/`}>
        <img
          width={400}
          height={210}
          src={
            post.data.ogImage
              ? post.data.ogImage
              : '/src/assets/images/content/blog/ogp.webp'
          }
          alt={post.data.ogImageAlt ? post.data.ogImageAlt : 'コンテンツです'}
        />
        <h1>{post.data.title}</h1>
      </a>
    ))
  }
</Layout>
